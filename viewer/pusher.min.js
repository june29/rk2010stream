/*!
 * Pusher JavaScript Library v1.6
 * http://pusherapp.com/
 *
 * Copyright 2010, New Bamboo
 * Released under the MIT licence.
 */

/*
 * This library contains code with the following licences:
 *
 * web_socket.js:
 *
 *   Copyright: Hiroshi Ichikawa <http://gimite.net/en/>
 *   License: New BSD License
 *   Reference: http://dev.w3.org/html5/websockets/
 *   Reference: http://tools.ietf.org/html/draft-hixie-thewebsocketprotocol
 *
 * swfobject.js:
 *
 *   SWFObject v2.2 <http://code.google.com/p/swfobject/>
 *   is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 *
 * FABridge.js:
 *
 *   Copyright 2006 Adobe Systems Incorporated
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"),
 *   to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 *   and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 */
if(!this.JSON)this.JSON={};
(function(){function a(r){return r<10?"0"+r:r}function c(r){k.lastIndex=0;return k.test(r)?'"'+r.replace(k,function(w){var t=m[w];return typeof t==="string"?t:"\\u"+("0000"+w.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+r+'"'}function b(r,w){var t,s,B,D,C=l,x,q=w[r];if(q&&typeof q==="object"&&typeof q.toJSON==="function")q=q.toJSON(r);if(typeof y==="function")q=y.call(w,r,q);switch(typeof q){case "string":return c(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);
case "object":if(!q)return"null";l+=z;x=[];if(Object.prototype.toString.apply(q)==="[object Array]"){D=q.length;for(t=0;t<D;t+=1)x[t]=b(t,q)||"null";B=x.length===0?"[]":l?"[\n"+l+x.join(",\n"+l)+"\n"+C+"]":"["+x.join(",")+"]";l=C;return B}if(y&&typeof y==="object"){D=y.length;for(t=0;t<D;t+=1){s=y[t];if(typeof s==="string")if(B=b(s,q))x.push(c(s)+(l?": ":":")+B)}}else for(s in q)if(Object.hasOwnProperty.call(q,s))if(B=b(s,q))x.push(c(s)+(l?": ":":")+B);B=x.length===0?"{}":l?"{\n"+l+x.join(",\n"+l)+
"\n"+C+"}":"{"+x.join(",")+"}";l=C;return B}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
k=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,z,m={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},y;if(typeof JSON.stringify!=="function")JSON.stringify=function(r,w,t){var s;z=l="";if(typeof t==="number")for(s=0;s<t;s+=1)z+=" ";else if(typeof t==="string")z=t;if((y=w)&&typeof w!=="function"&&(typeof w!=="object"||typeof w.length!=="number"))throw new Error("JSON.stringify");return b("",
{"":r})};if(typeof JSON.parse!=="function")JSON.parse=function(r,w){function t(B,D){var C,x,q=B[D];if(q&&typeof q==="object")for(C in q)if(Object.hasOwnProperty.call(q,C)){x=t(q,C);if(x!==undefined)q[C]=x;else delete q[C]}return w.call(B,D,q)}var s;r=String(r);g.lastIndex=0;if(g.test(r))r=r.replace(g,function(B){return"\\u"+("0000"+B.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(r.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){s=eval("("+r+")");return typeof w==="function"?t({"":s},""):s}throw new SyntaxError("JSON.parse");}})();
var swfobject=function(){function a(){if(!L){try{var d=n.getElementsByTagName("body")[0].appendChild(n.createElement("span"));d.parentNode.removeChild(d)}catch(e){return}L=true;d=P.length;for(var f=0;f<d;f++)P[f]()}}function c(d){if(L)d();else P[P.length]=d}function b(d){if(typeof E.addEventListener!=u)E.addEventListener("load",d,false);else if(typeof n.addEventListener!=u)n.addEventListener("load",d,false);else if(typeof E.attachEvent!=u)B(E,"onload",d);else if(typeof E.onload=="function"){var e=
E.onload;E.onload=function(){e();d()}}else E.onload=d}function g(){var d=n.getElementsByTagName("body")[0],e=n.createElement(F);e.setAttribute("type",Q);var f=d.appendChild(e);if(f){var h=0;(function(){if(typeof f.GetVariable!=u){var i=f.GetVariable("$version");if(i){i=i.split(" ")[1].split(",");j.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}}else if(h<10){h++;setTimeout(arguments.callee,10);return}d.removeChild(e);f=null;k()})()}else k()}function k(){var d=I.length;if(d>0)for(var e=
0;e<d;e++){var f=I[e].id,h=I[e].callbackFn,i={success:false,id:f};if(j.pv[0]>0){var p=s(f);if(p)if(D(I[e].swfVersion)&&!(j.wk&&j.wk<312)){x(f,true);if(h){i.success=true;i.ref=l(f);h(i)}}else if(I[e].expressInstall&&z()){i={};i.data=I[e].expressInstall;i.width=p.getAttribute("width")||"0";i.height=p.getAttribute("height")||"0";if(p.getAttribute("class"))i.styleclass=p.getAttribute("class");if(p.getAttribute("align"))i.align=p.getAttribute("align");var o={};p=p.getElementsByTagName("param");for(var A=
p.length,v=0;v<A;v++)if(p[v].getAttribute("name").toLowerCase()!="movie")o[p[v].getAttribute("name")]=p[v].getAttribute("value");m(i,o,f,h)}else{y(p);h&&h(i)}}else{x(f,true);if(h){if((f=l(f))&&typeof f.SetVariable!=u){i.success=true;i.ref=f}h(i)}}}}function l(d){var e=null;if((d=s(d))&&d.nodeName=="OBJECT")if(typeof d.SetVariable!=u)e=d;else if(d=d.getElementsByTagName(F)[0])e=d;return e}function z(){return!R&&D("6.0.65")&&(j.win||j.mac)&&!(j.wk&&j.wk<312)}function m(d,e,f,h){R=true;X=h||null;Z={success:false,
id:f};var i=s(f);if(i){if(i.nodeName=="OBJECT"){N=r(i);S=null}else{N=i;S=f}d.id=$;if(typeof d.width==u||!/%$/.test(d.width)&&parseInt(d.width,10)<310)d.width="310";if(typeof d.height==u||!/%$/.test(d.height)&&parseInt(d.height,10)<137)d.height="137";n.title=n.title.slice(0,47)+" - Flash Player Installation";h=j.ie&&j.win?"ActiveX":"PlugIn";h="MMredirectURL="+E.location.toString().replace(/&/g,"%26")+"&MMplayerType="+h+"&MMdoctitle="+n.title;if(typeof e.flashvars!=u)e.flashvars+="&"+h;else e.flashvars=
h;if(j.ie&&j.win&&i.readyState!=4){h=n.createElement("div");f+="SWFObjectNew";h.setAttribute("id",f);i.parentNode.insertBefore(h,i);i.style.display="none";(function(){i.readyState==4?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)})()}w(d,e,f)}}function y(d){if(j.ie&&j.win&&d.readyState!=4){var e=n.createElement("div");d.parentNode.insertBefore(e,d);e.parentNode.replaceChild(r(d),e);d.style.display="none";(function(){d.readyState==4?d.parentNode.removeChild(d):setTimeout(arguments.callee,
10)})()}else d.parentNode.replaceChild(r(d),d)}function r(d){var e=n.createElement("div");if(j.win&&j.ie)e.innerHTML=d.innerHTML;else if(d=d.getElementsByTagName(F)[0])if(d=d.childNodes)for(var f=d.length,h=0;h<f;h++)!(d[h].nodeType==1&&d[h].nodeName=="PARAM")&&d[h].nodeType!=8&&e.appendChild(d[h].cloneNode(true));return e}function w(d,e,f){var h,i=s(f);if(j.wk&&j.wk<312)return h;if(i){if(typeof d.id==u)d.id=f;if(j.ie&&j.win){var p="";for(var o in d)if(d[o]!=Object.prototype[o])if(o.toLowerCase()==
"data")e.movie=d[o];else if(o.toLowerCase()=="styleclass")p+=' class="'+d[o]+'"';else if(o.toLowerCase()!="classid")p+=" "+o+'="'+d[o]+'"';o="";for(var A in e)if(e[A]!=Object.prototype[A])o+='<param name="'+A+'" value="'+e[A]+'" />';i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+p+">"+o+"</object>";T[T.length]=d.id;h=s(d.id)}else{A=n.createElement(F);A.setAttribute("type",Q);for(var v in d)if(d[v]!=Object.prototype[v])if(v.toLowerCase()=="styleclass")A.setAttribute("class",
d[v]);else v.toLowerCase()!="classid"&&A.setAttribute(v,d[v]);for(p in e)if(e[p]!=Object.prototype[p]&&p.toLowerCase()!="movie"){d=p;o=e[p];v=n.createElement("param");v.setAttribute("name",d);v.setAttribute("value",o);A.appendChild(v)}i.parentNode.replaceChild(A,i);h=A}}return h}function t(d){var e=s(d);if(e&&e.nodeName=="OBJECT")if(j.ie&&j.win){e.style.display="none";(function(){if(e.readyState==4){var f=s(d);if(f){for(var h in f)if(typeof f[h]=="function")f[h]=null;f.parentNode.removeChild(f)}}else setTimeout(arguments.callee,
10)})()}else e.parentNode.removeChild(e)}function s(d){var e=null;try{e=n.getElementById(d)}catch(f){}return e}function B(d,e,f){d.attachEvent(e,f);M[M.length]=[d,e,f]}function D(d){var e=j.pv;d=d.split(".");d[0]=parseInt(d[0],10);d[1]=parseInt(d[1],10)||0;d[2]=parseInt(d[2],10)||0;return e[0]>d[0]||e[0]==d[0]&&e[1]>d[1]||e[0]==d[0]&&e[1]==d[1]&&e[2]>=d[2]?true:false}function C(d,e,f,h){if(!(j.ie&&j.mac)){var i=n.getElementsByTagName("head")[0];if(i){f=f&&typeof f=="string"?f:"screen";if(h)Y=G=null;
if(!G||Y!=f){h=n.createElement("style");h.setAttribute("type","text/css");h.setAttribute("media",f);G=i.appendChild(h);if(j.ie&&j.win&&typeof n.styleSheets!=u&&n.styleSheets.length>0)G=n.styleSheets[n.styleSheets.length-1];Y=f}if(j.ie&&j.win)G&&typeof G.addRule==F&&G.addRule(d,e);else G&&typeof n.createTextNode!=u&&G.appendChild(n.createTextNode(d+" {"+e+"}"))}}}function x(d,e){if(aa){var f=e?"visible":"hidden";if(L&&s(d))s(d).style.visibility=f;else C("#"+d,"visibility:"+f)}}function q(d){return/[\\\"<>\.;]/.exec(d)!=
null&&typeof encodeURIComponent!=u?encodeURIComponent(d):d}var u="undefined",F="object",Q="application/x-shockwave-flash",$="SWFObjectExprInst",E=window,n=document,J=navigator,ba=false,P=[function(){ba?g():k()}],I=[],T=[],M=[],N,S,X,Z,L=false,R=false,G,Y,aa=true,j=function(){var d=typeof n.getElementById!=u&&typeof n.getElementsByTagName!=u&&typeof n.createElement!=u,e=J.userAgent.toLowerCase(),f=J.platform.toLowerCase(),h=f?/win/.test(f):/win/.test(e);f=f?/mac/.test(f):/mac/.test(e);e=/webkit/.test(e)?
parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false;var i=!+"\u000b1",p=[0,0,0],o=null;if(typeof J.plugins!=u&&typeof J.plugins["Shockwave Flash"]==F){if((o=J.plugins["Shockwave Flash"].description)&&!(typeof J.mimeTypes!=u&&J.mimeTypes[Q]&&!J.mimeTypes[Q].enabledPlugin)){ba=true;i=false;o=o.replace(/^.*\s+(\S+\s+\S+$)/,"$1");p[0]=parseInt(o.replace(/^(.*)\..*$/,"$1"),10);p[1]=parseInt(o.replace(/^.*\.(.*)\s.*$/,"$1"),10);p[2]=/[a-zA-Z]/.test(o)?parseInt(o.replace(/^.*[a-zA-Z]+(.*)$/,
"$1"),10):0}}else if(typeof E.ActiveXObject!=u)try{var A=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(A)if(o=A.GetVariable("$version")){i=true;o=o.split(" ")[1].split(",");p=[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)]}}catch(v){}return{w3:d,pv:p,wk:e,ie:i,win:h,mac:f}}();(function(){if(j.w3){if(typeof n.readyState!=u&&n.readyState=="complete"||typeof n.readyState==u&&(n.getElementsByTagName("body")[0]||n.body))a();if(!L){typeof n.addEventListener!=u&&n.addEventListener("DOMContentLoaded",
a,false);if(j.ie&&j.win){n.attachEvent("onreadystatechange",function(){if(n.readyState=="complete"){n.detachEvent("onreadystatechange",arguments.callee);a()}});E==top&&function(){if(!L){try{n.documentElement.doScroll("left")}catch(d){setTimeout(arguments.callee,0);return}a()}}()}j.wk&&function(){L||(/loaded|complete/.test(n.readyState)?a():setTimeout(arguments.callee,0))}();b(a)}}})();(function(){j.ie&&j.win&&window.attachEvent("onunload",function(){for(var d=M.length,e=0;e<d;e++)M[e][0].detachEvent(M[e][1],
M[e][2]);d=T.length;for(e=0;e<d;e++)t(T[e]);for(var f in j)j[f]=null;j=null;for(var h in swfobject)swfobject[h]=null;swfobject=null})})();return{registerObject:function(d,e,f,h){if(j.w3&&d&&e){var i={};i.id=d;i.swfVersion=e;i.expressInstall=f;i.callbackFn=h;I[I.length]=i;x(d,false)}else h&&h({success:false,id:d})},getObjectById:function(d){if(j.w3)return l(d)},embedSWF:function(d,e,f,h,i,p,o,A,v,O){var U={success:false,id:e};if(j.w3&&!(j.wk&&j.wk<312)&&d&&e&&f&&h&&i){x(e,false);c(function(){f+="";
h+="";var K={};if(v&&typeof v===F)for(var H in v)K[H]=v[H];K.data=d;K.width=f;K.height=h;H={};if(A&&typeof A===F)for(var V in A)H[V]=A[V];if(o&&typeof o===F)for(var W in o)if(typeof H.flashvars!=u)H.flashvars+="&"+W+"="+o[W];else H.flashvars=W+"="+o[W];if(D(i)){V=w(K,H,e);K.id==e&&x(e,true);U.success=true;U.ref=V}else if(p&&z()){K.data=p;m(K,H,e,O);return}else x(e,true);O&&O(U)})}else O&&O(U)},switchOffAutoHideShow:function(){aa=false},ua:j,getFlashPlayerVersion:function(){return{major:j.pv[0],minor:j.pv[1],
release:j.pv[2]}},hasFlashPlayerVersion:D,createSWF:function(d,e,f){if(j.w3)return w(d,e,f)},showExpressInstall:function(d,e,f,h){j.w3&&z()&&m(d,e,f,h)},removeSWF:function(d){j.w3&&t(d)},createCSS:function(d,e,f,h){j.w3&&C(d,e,f,h)},addDomLoadEvent:c,addLoadEvent:b,getQueryParamValue:function(d){var e=n.location.search||n.location.hash;if(e){if(/\?/.test(e))e=e.split("?")[1];if(d==null)return q(e);e=e.split("&");for(var f=0;f<e.length;f++)if(e[f].substring(0,e[f].indexOf("="))==d)return q(e[f].substring(e[f].indexOf("=")+
1))}return""},expressInstallCallback:function(){if(R){var d=s($);if(d&&N){d.parentNode.replaceChild(N,d);if(S){x(S,true);if(j.ie&&j.win)N.style.display="block"}X&&X(Z)}R=false}}}}();function FABridge(a,c){this.target=a;this.remoteTypeCache={};this.remoteInstanceCache={};this.remoteFunctionCache={};this.localFunctionCache={};this.bridgeID=FABridge.nextBridgeID++;this.name=c;this.nextLocalFuncID=0;FABridge.instances[this.name]=this;FABridge.idMap[this.bridgeID]=this;return this}
FABridge.TYPE_ASINSTANCE=1;FABridge.TYPE_ASFUNCTION=2;FABridge.TYPE_JSFUNCTION=3;FABridge.TYPE_ANONYMOUS=4;FABridge.initCallbacks={};FABridge.userTypes={};FABridge.addToUserTypes=function(){for(var a=0;a<arguments.length;a++)FABridge.userTypes[arguments[a]]={typeName:arguments[a],enriched:false}};FABridge.argsToArray=function(a){for(var c=[],b=0;b<a.length;b++)c[b]=a[b];return c};function instanceFactory(a){this.fb_instance_id=a;return this}
function FABridge__invokeJSFunction(a){var c=a[0];a=a.concat();a.shift();return FABridge.extractBridgeFromID(c).invokeLocalFunction(c,a)}FABridge.addInitializationCallback=function(a,c){var b=FABridge.instances[a];if(b!=undefined)c.call(b);else{b=FABridge.initCallbacks[a];if(b==null)FABridge.initCallbacks[a]=b=[];b.push(c)}};
function FABridge__bridgeInitialized(a){var c=document.getElementsByTagName("object"),b=c.length,g=[];if(b>0)for(var k=0;k<b;k++)if(typeof c[k].SetVariable!="undefined")g[g.length]=c[k];b=document.getElementsByTagName("embed");k=b.length;c=[];if(k>0)for(var l=0;l<k;l++)if(typeof b[l].SetVariable!="undefined")c[c.length]=b[l];l=g.length;b=c.length;k="bridgeName="+a;if(l==1&&!b||l==1&&b==1)FABridge.attachBridge(g[0],a);else if(b==1&&!l)FABridge.attachBridge(c[0],a);else{var z=false;if(l>1)for(var m=
0;m<l;m++){for(var y=g[m].childNodes,r=0;r<y.length;r++){var w=y[r];if(w.nodeType==1&&w.tagName.toLowerCase()=="param"&&w.name.toLowerCase()=="flashvars"&&w.value.indexOf(k)>=0){FABridge.attachBridge(g[m],a);z=true;break}}if(z)break}if(!z&&b>1)for(g=0;g<b;g++)if(c[g].attributes.getNamedItem("flashVars").nodeValue.indexOf(k)>=0){FABridge.attachBridge(c[g],a);break}}return true}FABridge.nextBridgeID=0;FABridge.instances={};FABridge.idMap={};FABridge.refCount=0;
FABridge.extractBridgeFromID=function(a){return FABridge.idMap[a>>16]};FABridge.attachBridge=function(a,c){var b=new FABridge(a,c);FABridge[c]=b;var g=FABridge.initCallbacks[c];if(g!=null){for(var k=0;k<g.length;k++)g[k].call(b);delete FABridge.initCallbacks[c]}};FABridge.blockedMethods={toString:true,get:true,set:true,call:true};
FABridge.prototype={root:function(){return this.deserialize(this.target.getRoot())},releaseASObjects:function(){return this.target.releaseASObjects()},releaseNamedASObject:function(a){return typeof a!="object"?false:this.target.releaseNamedASObject(a.fb_instance_id)},create:function(a){return this.deserialize(this.target.create(a))},makeID:function(a){return(this.bridgeID<<16)+a},getPropertyFromAS:function(a,c){if(FABridge.refCount>0)throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.");
else{FABridge.refCount++;retVal=this.target.getPropFromAS(a,c);retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},setPropertyInAS:function(a,c,b){if(FABridge.refCount>0)throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.");else{FABridge.refCount++;retVal=this.target.setPropInAS(a,c,this.serialize(b));retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},
callASFunction:function(a,c){if(FABridge.refCount>0)throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.");else{FABridge.refCount++;retVal=this.target.invokeASFunction(a,this.serialize(c));retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},callASMethod:function(a,c,b){if(FABridge.refCount>0)throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.");
else{FABridge.refCount++;b=this.serialize(b);retVal=this.target.invokeASMethod(a,c,b);retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},invokeLocalFunction:function(a,c){var b,g=this.localFunctionCache[a];if(g!=undefined)b=this.serialize(g.apply(null,this.deserialize(c)));return b},getTypeFromName:function(a){return this.remoteTypeCache[a]},createProxy:function(a,c){var b=this.getTypeFromName(c);instanceFactory.prototype=b;b=new instanceFactory(a);return this.remoteInstanceCache[a]=
b},getProxy:function(a){return this.remoteInstanceCache[a]},addTypeDataToCache:function(a){newType=new ASProxy(this,a.name);for(var c=a.accessors,b=0;b<c.length;b++)this.addPropertyToType(newType,c[b]);a=a.methods;for(b=0;b<a.length;b++)FABridge.blockedMethods[a[b]]==undefined&&this.addMethodToType(newType,a[b]);return this.remoteTypeCache[newType.typeName]=newType},addPropertyToType:function(a,c){var b=c.charAt(0),g;if(b>="a"&&b<="z"){g="get"+b.toUpperCase()+c.substr(1);b="set"+b.toUpperCase()+c.substr(1)}else{g=
"get"+c;b="set"+c}a[b]=function(k){this.bridge.setPropertyInAS(this.fb_instance_id,c,k)};a[g]=function(){return this.bridge.deserialize(this.bridge.getPropertyFromAS(this.fb_instance_id,c))}},addMethodToType:function(a,c){a[c]=function(){return this.bridge.deserialize(this.bridge.callASMethod(this.fb_instance_id,c,FABridge.argsToArray(arguments)))}},getFunctionProxy:function(a){var c=this;if(this.remoteFunctionCache[a]==null)this.remoteFunctionCache[a]=function(){c.callASFunction(a,FABridge.argsToArray(arguments))};
return this.remoteFunctionCache[a]},getFunctionID:function(a){if(a.__bridge_id__==undefined){a.__bridge_id__=this.makeID(this.nextLocalFuncID++);this.localFunctionCache[a.__bridge_id__]=a}return a.__bridge_id__},serialize:function(a){var c={},b=typeof a;if(b=="number"||b=="string"||b=="boolean"||b==null||b==undefined)c=a;else if(a instanceof Array){c=[];for(b=0;b<a.length;b++)c[b]=this.serialize(a[b])}else if(b=="function"){c.type=FABridge.TYPE_JSFUNCTION;c.value=this.getFunctionID(a)}else if(a instanceof
ASProxy){c.type=FABridge.TYPE_ASINSTANCE;c.value=a.fb_instance_id}else{c.type=FABridge.TYPE_ANONYMOUS;c.value=a}return c},deserialize:function(a){var c,b=typeof a;if(b=="number"||b=="string"||b=="boolean"||a==null||a==undefined)c=this.handleError(a);else if(a instanceof Array){c=[];for(b=0;b<a.length;b++)c[b]=this.deserialize(a[b])}else if(b=="object"){for(b=0;b<a.newTypes.length;b++)this.addTypeDataToCache(a.newTypes[b]);for(var g in a.newRefs)this.createProxy(g,a.newRefs[g]);if(a.type==FABridge.TYPE_PRIMITIVE)c=
a.value;else if(a.type==FABridge.TYPE_ASFUNCTION)c=this.getFunctionProxy(a.value);else if(a.type==FABridge.TYPE_ASINSTANCE)c=this.getProxy(a.value);else if(a.type==FABridge.TYPE_ANONYMOUS)c=a.value}return c},addRef:function(a){this.target.incRef(a.fb_instance_id)},release:function(a){this.target.releaseRef(a.fb_instance_id)},handleError:function(a){if(typeof a=="string"&&a.indexOf("__FLASHERROR")==0){a=a.split("||");FABridge.refCount>0&&FABridge.refCount--;throw new Error(a[1]);}else return a}};
ASProxy=function(a,c){this.bridge=a;this.typeName=c;return this};ASProxy.prototype={get:function(a){return this.bridge.deserialize(this.bridge.getPropertyFromAS(this.fb_instance_id,a))},set:function(a,c){this.bridge.setPropertyInAS(this.fb_instance_id,a,c)},call:function(a,c){this.bridge.callASMethod(this.fb_instance_id,a,c)},addRef:function(){this.bridge.addRef(this)},release:function(){this.bridge.release(this)}};WEB_SOCKET_SWF_LOCATION="http://js.pusherapp.com/1.6/WebSocketMain.swf";
(function(){function a(){}if(!window.WebSocket){var c=window.console;c||(c={log:function(){},error:function(){}});if(function(){if("navigator"in window&&"plugins"in navigator&&navigator.plugins["Shockwave Flash"])return!!navigator.plugins["Shockwave Flash"].description;if("ActiveXObject"in window)try{return!!(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(b){}return false}()){c.log(location.protocol);location.protocol=="file:"&&c.error("web-socket-js doesn't work in file:///... URL (without special configuration). Open the page via Web server i.e. http://...");
WebSocket=function(b,g,k,l,z){var m=this;m.readyState=WebSocket.CONNECTING;m.bufferedAmount=0;setTimeout(function(){WebSocket.__addTask(function(){m.__createFlash(b,g,k,l,z)})},1)};WebSocket.prototype.__createFlash=function(b,g,k,l,z){var m=this;m.__flash=WebSocket.__flash.create(b,g,k||null,l||0,z||null);m.__flash.addEventListener("open",function(){try{m.readyState=m.__flash.getReadyState();m.__timer&&clearInterval(m.__timer);if(window.opera)m.__timer=setInterval(function(){m.__handleMessages()},
500);m.onopen&&m.onopen()}catch(y){c.error(y.toString())}});m.__flash.addEventListener("close",function(){try{m.readyState=m.__flash.getReadyState();m.__timer&&clearInterval(m.__timer);m.onclose&&m.onclose()}catch(y){c.error(y.toString())}});m.__flash.addEventListener("message",function(){try{m.__handleMessages()}catch(y){c.error(y.toString())}});m.__flash.addEventListener("error",function(){try{m.__timer&&clearInterval(m.__timer);m.onerror&&m.onerror()}catch(y){c.error(y.toString())}});m.__flash.addEventListener("stateChange",
function(y){try{m.readyState=m.__flash.getReadyState();m.bufferedAmount=y.getBufferedAmount()}catch(r){c.error(r.toString())}})};WebSocket.prototype.send=function(b){if(this.__flash)this.readyState=this.__flash.getReadyState();if(!this.__flash||this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";b=this.__flash.send(encodeURIComponent(b));if(b<0)return true;else{this.bufferedAmount=b;return false}};WebSocket.prototype.close=function(){if(this.__flash){this.readyState=
this.__flash.getReadyState();if(this.readyState==WebSocket.OPEN){this.__flash.close();this.readyState=WebSocket.CLOSED;this.__timer&&clearInterval(this.__timer);this.onclose&&this.onclose()}}};WebSocket.prototype.addEventListener=function(b,g){if(!("__events"in this))this.__events={};if(!(b in this.__events)){this.__events[b]=[];if("function"==typeof this["on"+b]){this.__events[b].defaultHandler=this["on"+b];this["on"+b]=this.__createEventHandler(this,b)}}this.__events[b].push(g)};WebSocket.prototype.removeEventListener=
function(b,g){if(!("__events"in this))this.__events={};if(b in this.__events)for(var k=this.__events.length;k>-1;--k)if(g===this.__events[b][k]){this.__events[b].splice(k,1);break}};WebSocket.prototype.dispatchEvent=function(b){if(!("__events"in this))throw"UNSPECIFIED_EVENT_TYPE_ERR";if(!(b.type in this.__events))throw"UNSPECIFIED_EVENT_TYPE_ERR";for(var g=0,k=this.__events[b.type].length;g<k;++g){this.__events[b.type][g](b);if(b.cancelBubble)break}false!==b.returnValue&&"function"==typeof this.__events[b.type].defaultHandler&&
this.__events[b.type].defaultHandler(b)};WebSocket.prototype.__handleMessages=function(){for(var b=this.__flash.readSocketData(),g=0;g<b.length;g++){var k=decodeURIComponent(b[g]);try{if(this.onmessage){var l;if(window.MessageEvent){l=document.createEvent("MessageEvent");l.initMessageEvent("message",false,false,k,null,null,window,null)}else l={data:k};this.onmessage(l)}}catch(z){c.error(z.toString())}}};WebSocket.prototype.__createEventHandler=function(b,g){return function(k){var l=new a;l.initEvent(g,
true,true);l.target=l.currentTarget=b;for(var z in k)l[z]=k[z];b.dispatchEvent(l,arguments)}};a.prototype.cancelable=true;a.prototype.cancelBubble=false;a.prototype.preventDefault=function(){if(this.cancelable)this.returnValue=false};a.prototype.stopPropagation=function(){this.cancelBubble=true};a.prototype.initEvent=function(b,g,k){this.type=b;this.cancelable=k;this.timeStamp=new Date};WebSocket.CONNECTING=0;WebSocket.OPEN=1;WebSocket.CLOSING=2;WebSocket.CLOSED=3;WebSocket.__tasks=[];WebSocket.__initialize=
function(){if(WebSocket.__swfLocation)window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation;if(window.WEB_SOCKET_SWF_LOCATION){var b=document.createElement("div");b.id="webSocketContainer";b.style.position="absolute";b.style.left="-100px";b.style.top="-100px";var g=document.createElement("div");g.id="webSocketFlash";b.appendChild(g);document.body.appendChild(b);swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","8","8","9.0.0",null,{bridgeName:"webSocket"},{allowScriptAccess:"always"},null,
function(k){k.success||c.error("[WebSocket] swfobject.embedSWF failed")});FABridge.addInitializationCallback("webSocket",function(){try{WebSocket.__flash=FABridge.webSocket.root();WebSocket.__flash.setCallerUrl(location.href);WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var k=0;k<WebSocket.__tasks.length;++k)WebSocket.__tasks[k]();WebSocket.__tasks=[]}catch(l){c.error("[WebSocket] "+l.toString())}})}else c.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf")};
WebSocket.__addTask=function(b){WebSocket.__flash?b():WebSocket.__tasks.push(b)};window.webSocketLog=function(b){c.log(decodeURIComponent(b))};window.webSocketError=function(b){c.error(decodeURIComponent(b))};window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",WebSocket.__initialize,false):window.attachEvent("onload",WebSocket.__initialize))}else c.error("Flash Player is not installed.")}})();
if(typeof Function.prototype.scopedTo=="undefined")Function.prototype.scopedTo=function(a,c){var b=this;return function(){return b.apply(a,Array.prototype.slice.call(c||[]).concat(Array.prototype.slice.call(arguments)))}};
var Pusher=function(a,c){this.path="/app/"+a;this.key=a;this.channels=new Pusher.Channels;this.global_channel=new Pusher.Channel("pusher_global_channel");this.global_channel.global=true;this.connected=this.secure=false;this.retry_counter=0;this.connect();c&&this.subscribe(c);this.bind("pusher:connection_established",function(b){this.connected=true;this.retry_counter=0;this.socket_id=b.socket_id;this.subscribeAll()}.scopedTo(this));this.bind("pusher:connection_disconnected",function(){for(var b in this.channels.channels)this.channels.channels[b].disconnect()}.scopedTo(this));
this.bind("pusher:error",function(b){Pusher.log("Pusher : error : "+b.message)})};
Pusher.prototype={channel:function(a){return this.channels.find(a)},connect:function(){var a="ws://"+Pusher.host+":"+Pusher.ws_port+this.path;if(this.secure==true)a="wss://"+Pusher.host+":"+Pusher.wss_port+this.path;Pusher.allow_reconnect=true;Pusher.log("Pusher : connecting : "+a);var c=this;if(window.WebSocket){this.connection=new WebSocket(a);this.connection.onmessage=function(){c.onmessage.apply(c,arguments)};this.connection.onclose=function(){c.onclose.apply(c,arguments)};this.connection.onopen=
function(){c.onopen.apply(c,arguments)}}else{this.connection={};setTimeout(function(){c.send_local_event("pusher:connection_failed",{})},3E3)}},toggle_secure:function(){if(this.secure==false){this.secure=true;Pusher.log("Pusher: switching to wss:// connection")}else{this.secure=false;Pusher.log("Pusher: switching to ws:// connection")}},disconnect:function(){Pusher.log("Pusher : disconnecting");Pusher.allow_reconnect=false;Pusher.retry_count=0;this.connection.close()},bind:function(a,c){this.global_channel.bind(a,
c);return this},bind_all:function(a){this.global_channel.bind_all(a);return this},subscribeAll:function(){for(var a in this.channels.channels)this.channels.channels.hasOwnProperty(a)&&this.subscribe(a)},subscribe:function(a){var c=this.channels.add(a);this.connected&&c.authorize(this,function(b){this.send_event("pusher:subscribe",{channel:a,auth:b.auth,channel_data:b.channel_data})}.scopedTo(this));return c},unsubscribe:function(a){this.channels.remove(a);this.connected&&this.send_event("pusher:unsubscribe",
{channel:a})},send_event:function(a,c){var b=JSON.stringify({event:a,data:c,js_version:Pusher.VERSION});Pusher.log("Pusher : sending event : ",b);this.connection.send(b);return this},send_local_event:function(a,c,b){c=Pusher.data_decorator(a,c);if(b){var g=this.channel(b);g&&g.dispatch_with_all(a,c)}this.global_channel.dispatch_with_all(a,c);Pusher.log("Pusher : event received : channel: "+b+"; event: "+a,c)},onmessage:function(a){a=Pusher.parser(a.data);if(!(a.socket_id&&a.socket_id==this.socket_id)){var c=
a.event,b=Pusher.parser(a.data);this.send_local_event(c,b,a.channel)}},wait_and_reconnect:function(a,c){setTimeout(function(){a();this.connect()}.scopedTo(this),c)},onclose:function(){var a=this;this.global_channel.dispatch("close",null);Pusher.log("Pusher: Socket closed");var c=5E3;if(this.connected==true){this.send_local_event("pusher:connection_disconnected",{});if(Pusher.allow_reconnect){Pusher.log("Pusher : Reconnecting in 5 seconds...");this.wait_and_reconnect(function(){},c)}}else{a.send_local_event("pusher:connection_failed",
{});if(this.retry_counter==0)c=100;this.retry_counter+=1;this.wait_and_reconnect(function(){a.toggle_secure()},c)}this.connected=false},onopen:function(){this.global_channel.dispatch("open",null)}};Pusher.Util={extend:function(a,c){for(var b in c)a[b]=c[b];return a}};Pusher.VERSION="1.6.0";Pusher.host="ws.pusherapp.com";Pusher.ws_port=80;Pusher.wss_port=443;Pusher.channel_auth_endpoint="/pusher/auth";Pusher.log=function(){};Pusher.data_decorator=function(a,c){return c};Pusher.allow_reconnect=true;
Pusher.parser=function(a){try{return JSON.parse(a)}catch(c){Pusher.log("Pusher : data attribute not valid JSON - you may wish to implement your own Pusher.parser");return a}};Pusher.Channels=function(){this.channels={}};Pusher.Channels.prototype={add:function(a){var c=this.find(a);if(c)return c;else{c=Pusher.Channel.factory(a);return this.channels[a]=c}},find:function(a){return this.channels[a]},remove:function(a){delete this.channels[a]}};
Pusher.Channel=function(a){this.name=a;this.callbacks={};this.global_callbacks=[];this.subscribed=false};
Pusher.Channel.prototype={init:function(){},disconnect:function(){},acknowledge_subscription:function(){this.subscribed=true},bind:function(a,c){this.callbacks[a]=this.callbacks[a]||[];this.callbacks[a].push(c);return this},bind_all:function(a){this.global_callbacks.push(a);return this},dispatch_with_all:function(a,c){this.dispatch(a,c);this.dispatch_global_callbacks(a,c)},dispatch:function(a,c){var b=this.callbacks[a];if(b)for(var g=0;g<b.length;g++)b[g](c);else this.global||Pusher.log("Pusher : No callbacks for "+
a)},dispatch_global_callbacks:function(a,c){for(var b=0;b<this.global_callbacks.length;b++)this.global_callbacks[b](a,c)},is_private:function(){return false},is_presence:function(){return false},authorize:function(a,c){c({})}};
Pusher.Channel.PrivateChannel={is_private:function(){return true},authorize:function(a,c){var b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.open("POST",Pusher.channel_auth_endpoint,true);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.onreadystatechange=function(){if(b.readyState==4)if(b.status==200){var g=Pusher.parser(b.responseText);c(g)}else Pusher.log("Couldn't get auth info from your webapp"+status)};b.send("socket_id="+encodeURIComponent(a.socket_id)+
"&channel_name="+encodeURIComponent(this.name))}};
Pusher.Channel.PresenceChannel={init:function(){this.bind("pusher_internal:subscription_succeeded",function(a){this.acknowledge_subscription(a);this.dispatch_with_all("pusher:subscription_succeeded",this.members())}.scopedTo(this));this.bind("pusher_internal:member_added",function(a){if(this.member_exists(a))return false;this.add_member(a);this.dispatch_with_all("pusher:member_added",a)}.scopedTo(this));this.bind("pusher_internal:member_removed",function(a){this.remove_member(a);this.dispatch_with_all("pusher:member_removed",
a)}.scopedTo(this))},disconnect:function(){this._members_map={}},acknowledge_subscription:function(a){this._members_map={};for(var c=0;c<a.length;c++)this._members_map[a[c].user_id]=a[c];this.subscribed=true},member_exists:function(a){return typeof this._members_map[a.user_id]!="undefined"},is_presence:function(){return true},members:function(){var a=[];for(var c in this._members_map)a.push(this._members_map[c]);return a},add_member:function(a){this._members_map[a.user_id]=a},remove_member:function(a){delete this._members_map[a.user_id]}};
Pusher.Channel.factory=function(a){var c=new Pusher.Channel(a);if(a.indexOf(Pusher.Channel.private_prefix)===0)Pusher.Util.extend(c,Pusher.Channel.PrivateChannel);else if(a.indexOf(Pusher.Channel.presence_prefix)===0){Pusher.Util.extend(c,Pusher.Channel.PrivateChannel);Pusher.Util.extend(c,Pusher.Channel.PresenceChannel)}c.init();return c};Pusher.Channel.private_prefix="private-";Pusher.Channel.presence_prefix="presence-";
